<%- include("../layout/header") %>
<%- include("../layout/layoutnavbar") %>
<% if(locals.user){ %>
    <div class="container p-4 mb-5 shadow" style="background-color: white;">
        <h3 class="text-center mt-lg-0 mt-md-4 mt-sm-4 ">แก้ไขข้อมูลส่วนตัว</h3>
        <form method="POST" action="/user/edit" enctype="multipart/form-data">
            <div class="row">
                <div class="col-md-6 col-12 p-md-5">
                    <div class="btn-edit">
                        <div class="form-group mt-3">
                            <label for="">ชื่อผู้ใช้งาน :<i class="fas fa-user-edit" onclick="ClickEnableEditname()" style="cursor: pointer;">Edit</i></label>
                            <div class="mt-2">
                                <input type="text" class="form-control" name="username" value="<%= user.username %>" id="edit_username" required>
                            </div>
                        </div>
                        <hr>
                        <div class="form-group mt-3">
                            <label for="">อีเมล :<i class="fas fa-user-edit" onclick="ClickEnableEditemail()" style="cursor: pointer;">Edit</i></label>
                            <div class="mt-2">
                                <input type="email" class="form-control" name="email" value="<%= user.email %>" id="edit_email" required>
                            </div>
                        </div> 
                        <div class="mt-3 mb-3">
                            <label class="" for="customFile">อัพโหลดรูปโปรไฟล์</label>
                            <input type="file" name="imgprofile" id="img_preview" class="form-control-file">
                            <div class="text-center">
                                <img src="https://res.cloudinary.com/dvzib8cte/image/upload/v1593015941/<%= user.image %>" id="img_show" alt="" class="img-crop-preview-edit">
                                <p>รูปภาพตัวอย่าง</p>
                            </div> 
                        </div>     
                    </div>
                    
                </div>
                <div class="col-md-6 col-12 p-md-5">
                    <div class="form-group mt-3">
                        <label for="">เบอร์โทร</label>
                        <div class="mt-2">
                            <input type="text" class="form-control" name="phone" id="" value="<%= user.contact.phone %>">
                        </div>
                    </div>
                    <div class="form-group mt-3">
                        <label for="facebook">Facebook (url หน้า profile facebook ของคุณ)</label>
                        <div class="mt-2">
                            <input type="url" class="form-control" name="facebook" value="<%= user.contact.facebook %>">
                        </div>
                    </div>
                    <div class="form-group mt-3">
                        <label for="">ID Line</label>
                        <div class="mt-2">
                            <input type="text" class="form-control" name="line" value="<%= user.contact.line %>">
                        </div>
                    </div>
                </div>
                
            </div>
            <div class="m-3">
                    <button type="submit" class="btn btn-success" >save</button>
                    <button type="reset" class="btn btn-primary" onclick="Clickreset()">reset</button>
                </div>
        </form>
        <script>
            // document.getElementById("edit_username").disabled = true;
            function ClickEnableEditname()
            {
                document.getElementById("edit_username").disabled = false;
            }
            // document.getElementById("edit_email").disabled = true;
            function ClickEnableEditemail()
            {
                document.getElementById("edit_email").disabled = false;
            }
            // document.getElementById("edit_password").disabled = true;
            // document.getElementById("edit_password1").disabled = true;
            function ClickEnableEditpassword()
            {
                document.getElementById("edit_password").disabled = false;
                document.getElementById("edit_password1").disabled = false;
            }
            function Clickreset()
            {
                document.getElementById("edit_username").disabled = true;
                document.getElementById("edit_email").disabled = true;
                document.getElementById("edit_password").disabled = true;
                document.getElementById("edit_password1").disabled = true;
            }

            var filename = document.getElementById("img_preview");
            filename.onchange = function()
            {
                var file = filename.files[0];
                var reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = function()
                {
                    var result = reader.result;
                    document.getElementById("img_show").src = result;
                };
            };
        </script>
    </div>
<% } %> 
<% if(!locals.user){ %>
    <div class="text-center p-5"><h2>Please Login!</h2></div>
<% } %> 
